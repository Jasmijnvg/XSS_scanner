package com.jasmi.xss_scanner.mappers;

import com.jasmi.xss_scanner.dtos.VulnerabilityInputDto;
import com.jasmi.xss_scanner.dtos.VulnerabilityOutputDto;
import com.jasmi.xss_scanner.models.Solution;
import com.jasmi.xss_scanner.models.Vulnerability;
import org.springframework.stereotype.Component;

import java.util.List;
import java.util.stream.Collectors;

@Component
public class VulnerabilityMapper {
    private final SolutionMapper solutionMapper;

    public VulnerabilityMapper(SolutionMapper solutionMapper) {
        this.solutionMapper = solutionMapper;
    }

    public VulnerabilityOutputDto toVulnerabilityDto(Vulnerability vulnerability) {
        var dto = new VulnerabilityOutputDto();

        dto.setId(vulnerability.getId());
        dto.setName(vulnerability.getName());
        dto.setDescription(vulnerability.getDescription());
        dto.setCode(vulnerability.getCode());
        if(vulnerability.getSolutions()!=null) {
            dto.setSolutions(vulnerability.getSolutions()
                    .stream()
                    .map(solutionMapper::toSolutionDto)
                    .collect(Collectors.toList()));
        }
        return dto;
    }

    public Vulnerability toVulnerability(VulnerabilityInputDto dto){
        var vulnerability = new Vulnerability();

        vulnerability.setName(dto.getName());
        vulnerability.setDescription(dto.getDescription());
        vulnerability.setCode(dto.getCode());

        return vulnerability;
    }

}
